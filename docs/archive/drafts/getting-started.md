# Getting Started
Starting to build data transformations using `flowfunctions` does not require any signup or installation, and will work for any authenticated BigQuery user.  This walkthrough will show you how to get up and running in a matter of minutes.  

## Initialisation (`transform.begin`)
To begin a transformation flow, the first step is to declare the `sql_blocks` array variable which will contain all of the transformation flow stages.  The simplest way of doing this is to generate the boilerplate code by running the following command in the Query editor:
```
CALL txflow.transform.begin()
```
When you execute this command (by clicking `Run`), you will see the boilerplate code generated in the results pane below the Query editor.

There are three sections to this code:
- parameter definitions
- transformation flow
- transformation flow outputs

Note that a double dash comments out the line (so that line won't be executed), but the leading and closing `'----'` and `'--'` are just convention for readability and will not effect execution or parsing.

### Parameters
This is the section where you need to declare any parameters to be used in the transformation flow, with the syntax defined by BigQuery [DECLARE](https://cloud.google.com/bigquery/docs/reference/standard-sql/scripting#declare).  All parameters need to be defined at the start of the script, so additional parameters should be declared here if required.  This section will initially only contain the declaration of the `sql_blocks` array variable, which will hold the information pertaining to each flow stage:
```
---- parameter definitions ---- 
-- sql_blocks ordered array variable of transformation flow stages --
DECLARE sql_blocks ARRAY<STRUCT<name STRING, code STRING, dependencies ARRAY<STRING>>>;
```
Every time a transformation flow stage is added, the transformation stage `name`, `code` and `dependencies` will be added as to the end of this `sql_blocks` array.

### Transformation Flow
This is the core section where the transformation flow stages are defined. Initially, this contains a single `get_data` stage, which is used to get data from a single source table or view.
```
---- transformation flow ----
CALL txflow.transform.get_data('inbound_data', sql_blocks, 
"SELECT * FROM ", 'source_ref', " ");
```

This function has five parameters:
- **sql_block_name**: defaulted to 'inbound_data'
- **sql_blocks**: `sql_blocks` variable declared above
- **select_clause**: "SELECT * FROM "
- **source_ref**: defaulted to "SELECT * FROM "
- **where_clause**: defaulted to 'source_ref'

Note that the `SELECT` and `FROM` can be omitted from the `select_clause` (i.e. in this instance you could just set it to "*") but it is recommended to include them for readability.  Likewise, if including `where_clause` clause then the `WHERE` can be omitted.

You can also include any number of additional statements within the `select_clause` and `where_clause` in line with the BigQuery [query syntax](https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax) but the `source_ref` parameter will only take a single table or view reference as an input, meaning that the `get_data` function only gets data from a single source.  

This is intended as it segregates data import from complex transformations, making the transformation flow more modular and therefore easier to read, test and debug. 

### Transformation Flow Outputs
Once all of the flow stages are complete, then the functions in this section determine the action(s) to be taken with the transformation flow, which can be:
- build a single common table expression based SQL query and return the **query** (`build_sql_blocks_query`)
- build a single common table expression based SQL query and execute the resulting query, returning the **query result** (`execute_sql_blocks`)
- build a single common table expression-based SQL query and **create a single view** (`create_view_from_sql_blocks`)
- build multiple single queries and **create a single view for each stage** (`create_views_from_sql_blocks`)

Note that in the boilerplate code, the transformation flow output will simply return the SQL generated by the flow:
```
---- transformation flow outputs ---
CALL txflow.blocks.build_sql_blocks_query(sql_blocks);
```
TODO: create a `return_sql_blocks_query` so that the tutorial works.
### Initial Execution


## Query Building


## Query Excution


## SQL Blocks Actions